# üî§ RESTORE_WATERMARK: –°–∏—Å—Ç–µ–º–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞

–í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ **Rust** –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–Ω–∞–ª–∏–∑–∞ —à–∏—Ä–∏–Ω—ã —Å–∏–º–≤–æ–ª–æ–≤ –∏ **–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –º–µ—Ç–æ–¥–æ–≤ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –≤–æ–¥—è–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤** –Ω–∞ –æ—Å–Ω–æ–≤–µ FFT –∏ –º–Ω–æ–≥–æ–±–∞–∑–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º.

---

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
- [–¶–∏—Ñ—Ä–æ–≤—ã–µ –≤–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏](#—Ü–∏—Ñ—Ä–æ–≤—ã–µ-–≤–æ–¥—è–Ω—ã–µ-–∑–Ω–∞–∫–∏)
- [–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫)
- [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ-—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏)

---

## üéØ –û–±–∑–æ—Ä

**RESTORE_WATERMARK** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —É—Å—Ç–æ–π—á–∏–≤—ã—Ö –∫ –∞—Ç–∞–∫–∞–º —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –≤–æ–¥—è–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤:

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚úÖ **10 —Ñ–∞–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏** - –æ—Ç –∏–∑–º–µ—Ä–µ–Ω–∏—è —à—Ä–∏—Ñ—Ç–æ–≤ –¥–æ FFT –º–Ω–æ–≥–æ–±–∞–∑–æ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞  
‚úÖ **–¶–∏—Ñ—Ä–æ–≤—ã–µ –≤–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏** - –º–Ω–æ–≥–æ–æ—Å–µ–≤—ã–µ, —Ñ–∞–∑–æ–∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω—ã–µ, –Ω–∞ –æ—Å–Ω–æ–≤–µ —è–∫–æ—Ä–µ–π  
‚úÖ **FFT –±–ª–æ—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞** - –±—ã—Å—Ç—Ä–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ —Å –∞–Ω–∞–ª–∏–∑–æ–º —ç–Ω–µ—Ä–≥–∏–∏ –±–ª–æ–∫–æ–≤  
‚úÖ **–ú–Ω–æ–≥–æ–±–∞–∑–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞** - –≤–∑–≤–µ—à–µ–Ω–Ω—ã–µ –±–∞–∑–∏—Å—ã —Å –º–µ–¥–∏–∞–Ω–Ω–æ–π —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å—é  
‚úÖ **3D —Å–µ—Ç–æ—á–Ω—ã–µ –≤–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏** - –¥–ª—è –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π –∏ —Å–µ—Ç–æ–∫  
‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∏—Ä–∏–ª–ª–∏—Ü—ã** - —Ä—É—Å—Å–∫–∏–π, —É–∫—Ä–∞–∏–Ω—Å–∫–∏–π –∏ –¥—Ä—É–≥–∏–µ —è–∑—ã–∫–∏  
‚úÖ **–ù—É–ª–µ–≤—ã—Ö –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π** - —á–∏—Å—Ç—ã–π –∫–æ–¥ –Ω–∞ Rust  

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ü–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (10 —Ñ–∞–∑)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   INPUT: PDF/–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ        ‚îÇ
‚îÇ   (–ò–∑–º–µ—Ä–µ–Ω–Ω—ã–µ —à–∏—Ä–∏–Ω—ã)           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚Üì
    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
    ‚ïë    –§–ê–ó–ê 1-4: –ë–ê–ó–û–í–ê–Ø –°–ò–°–¢–ï–ú–ê
    ‚ïë     (N-–ì–†–ê–ú–ú + –Ø–ö–û–†–Ø)
    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
         ‚Üì
    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
    ‚ïë  –§–ê–ó–ê 5: –¢–†–ê–ù–°–§–û–†–ú–ê–¶–ò–ò      ‚ïë
    ‚ïë   Noise, Scaling, Permute   ‚ïë
    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
         ‚Üì
    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
    ‚ïë –§–ê–ó–ê 6-9: –ü–†–û–î–í–ò–ù–£–¢–´–ï       ‚ïë
    ‚ïë  —Ñ–∞–∑–æ–∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å        ‚ïë
    ‚ïë  —è–∫–æ—Ä—è + PDF               ‚ïë
    ‚ïë  3D —Å–µ—Ç–∫–∏                   ‚ïë
    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
         ‚Üì
    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
    ‚ïë  –§–ê–ó–ê 10: FFT + –ë–ê–ó–ò–°–´      ‚ïë
    ‚ïë  –ë–ª–æ—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å –º–µ–¥–∏–∞–Ω–æ–π ‚ïë
    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
         ‚Üì
     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚îÇ  OUTPUT: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
     ‚îÇ  (—Å –æ—Ü–µ–Ω–∫–∞–º–∏ –∏ –≤–æ–¥—è–Ω—ã–º–∏ –∑–Ω–∞–∫–∞–º–∏)
     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîß –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –§–∞–∑—ã 1-4: –ë–∞–∑–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

**[–û–ø–∏—Å–∞–Ω–∏–µ –§–∞–∑ 1-4 —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–µ–π README]**

---

## üíß –¶–∏—Ñ—Ä–æ–≤—ã–µ –≤–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏

### –§–∞–∑–∞ 5: –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ –∞—Ç–∞–∫–∏

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∞—Ç–∞–∫–∏:**
- `add_noise(signal, amplitude)` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥–∞—É—Å—Å–æ–≤–∞ —à—É–º–∞
- `scale_signal(signal, factor)` - –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞
- `crop_signal(signal, ratio)` - –æ–±—Ä–µ–∑–∫–∞ —Å–∏–≥–Ω–∞–ª–∞
- `permute_signal(signal)` - –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Ç—Å—á–µ—Ç–æ–≤

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã (–±–∞–∑–æ–≤—ã–µ –≤–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏):**

| –¢–∏–ø –∞—Ç–∞–∫–∏ | –û—Ü–µ–Ω–∫–∞ | –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|-----------|--------|---|---|
| –®—É–º ¬±0.15 | 0.01748 | 24.25% | –£–º–µ—Ä–µ–Ω–Ω–æ |
| –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ √ó3.7 | 0.07208 | **100.00%** | ‚úÖ –ò–¥–µ–∞–ª—å–Ω–æ |
| –û–±—Ä–µ–∑–∫–∞ 60% | 0.04053 | 56.23% | –•–æ—Ä–æ—à–æ |
| –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ | 0.01031 | 14.30% | –°–ª–∞–±–æ |
| –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è | 0.03621 | 50.23% | –£–º–µ—Ä–µ–Ω–Ω–æ |

**–°—Ä–µ–¥–Ω–µ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ: 49.00%**

### –§–∞–∑–∞ 6: –§–∞–∑–æ–∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω—ã–π —Å–∫–æ—Ä–∏–Ω–≥

**–§–æ—Ä–º—É–ª–∞ —Ñ–∞–∑–æ–∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ–≥–æ —Å–∫–æ—Ä–∞:**

```
PhaseInvariantScore(s, l) = ‚àö(Œ£(s_i √ó l_i)¬≤)
```

–≥–¥–µ `s` - —Å–∏–≥–Ω–∞–ª, `l` - —Ä–µ—à–µ—Ç–∫–∞ –≤–æ–¥—è–Ω–æ–≥–æ –∑–Ω–∞–∫–∞

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Ñ–∞–∑–æ–≤—ã–º —Å–¥–≤–∏–≥–∞–º
- –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å –∫ –∞–º–ø–ª–∏—Ç—É–¥–Ω—ã–º –≤–∞—Ä–∏–∞—Ü–∏—è–º
- –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤ –∫–≤–∞–¥—Ä–∞—Ç–µ

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

| –§–∞–∑–æ–≤—ã–π —Å–¥–≤–∏–≥ | PI Score | –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π |
|---|---|---|
| 0.0 | 6.2428 | 1.0000 |
| +0.1 | 6.4350 | 1.0308 |
| +0.5 | 8.1351 | 1.3031 |
| +1.0 | 11.4430 | 1.8330 |
| +2.0 | 19.3168 | 3.0942 |

**–í—ã–≤–æ–¥:** –§–∞–∑–æ–∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤–æ–¥—è–Ω–æ–≥–æ –∑–Ω–∞–∫–∞ –ø—Ä–∏ —Å–¥–≤–∏–≥–∞—Ö.

### –§–∞–∑–∞ 7: –Ø–∫–æ—Ä—è (Anchor-Aware Watermarking)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —è–∫–æ—Ä—è:**
```rust
pub struct Anchor {
    pub text: String,           // –¢–µ–∫—Å—Ç —è–∫–æ—Ä—è
    pub bbox_width: f64,        // –®–∏—Ä–∏–Ω–∞ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–µ–≥–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞
    pub position: usize,        // –ü–æ–∑–∏—Ü–∏—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ
}
```

**–†–µ—à–µ—Ç–∫–∞ —è–∫–æ—Ä—è (—Å–∏–Ω—É—Å–æ–∏–¥–∞–ª—å–Ω–∞—è –º–æ–¥—É–ª—è—Ü–∏—è):**

```
anchor_lattice[i] = sin(i √ó frequency)
–≥–¥–µ frequency = bbox_width / 10.0
```

**–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä–µ—à–µ—Ç–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —è–∫–æ—Ä–µ–π:**

```
combined[i] = Œ£ anchor_lattice_j[i]
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã (3 —è–∫–æ—Ä—è):**
- –®–∏—Ä–∏–Ω—ã —è–∫–æ—Ä–µ–π: 51.58, 60.48, 50.67 px
- –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä–µ—à–µ—Ç–∫–∞: [-2.95, +2.81]
- –í–æ–¥—è–Ω–æ–π –∑–Ω–∞–∫ —Å–∏–≥–Ω–∞–ª: **17.0444**
- –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —à—É–º—É: **100.06%** (–∏–¥–µ–∞–ª—å–Ω–æ!)

### –§–∞–∑–∞ 8: 3D —Å–µ—Ç–æ—á–Ω—ã–µ –≤–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ 3D –º–æ–¥–µ–ª—è–º:**

```
Vertices: [v‚ÇÄ, v‚ÇÅ, v‚ÇÇ, ...v‚Çô]
Edges: [(i‚ÇÅ, j‚ÇÅ), (i‚ÇÇ, j‚ÇÇ), ...]

EdgeLength[k] = ‚àö((v·µ¢.x - v‚±º.x)¬≤ + (v·µ¢.y - v‚±º.y)¬≤ + (v·µ¢.z - v‚±º.z)¬≤)
```

**–í–æ–¥—è–Ω–æ–π –∑–Ω–∞–∫ —Å–µ—Ç–∫–∏:**
```
MeshWatermark(signal, lattice) = PhaseInvariantScore(signal, EdgeLength)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã (–∫—É–± 8 –≤–µ—Ä—à–∏–Ω √ó 12 —Ä—ë–±–µ—Ä):**
- –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å–∏–≥–Ω–∞–ª —Å–µ—Ç–∫–∏: **3.4641**
- –ü–æ—Å–ª–µ –¥–µ—Ñ–æ—Ä–º–∞—Ü–∏–∏ (11%, -5%, +5%): **3.5861**
- –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –¥–µ—Ñ–æ—Ä–º–∞—Ü–∏–∏: **103.52%** ‚úÖ

### –§–∞–∑–∞ 9: –í—ã–≤–æ–¥ –∏–∑ PDF-—Ç–µ–∫—Å—Ç–∞

**–°—Ç—Ä—É–∫—Ç—É—Ä—ã:**
```rust
pub struct BBox {
    pub x: f32,     // X –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞
    pub y: f32,     // Y –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞
    pub w: f32,     // –®–∏—Ä–∏–Ω–∞ (–¥–ª—è –≤–æ–¥—è–Ω–æ–≥–æ –∑–Ω–∞–∫–∞!)
    pub h: f32,     // –í—ã—Å–æ—Ç–∞
}

pub struct PdfLine {
    pub bbox: BBox,
    pub width: f32,
}
```

**–°–∏–≥–Ω–∞–ª –∏–∑ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏—Ö –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤:**

```
signal = normalize([width‚ÇÅ, width‚ÇÇ, ..., width‚Çô])
signal_normalized[i] = width[i] / ‚àö(Œ£ width¬≤)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã (6 —Å—Ç—Ä–æ–∫):**
- –ò—Å—Ö–æ–¥–Ω—ã–µ —à–∏—Ä–∏–Ω—ã: [51.58, 60.48, 50.67, 55.25, 52.10, 61.33] px
- –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å–∏–≥–Ω–∞–ª: –Ω–æ—Ä–º–∞ = **1.0000** ‚úì
- –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏: **‚úÖ –ü–æ–ª–Ω–∞—è**

---

## üìä –§–∞–∑–∞ 10: FFT –ú–Ω–æ–≥–æ–±–∞–∑–æ–≤—ã–µ –≤–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏

### –¢–µ–æ—Ä–∏—è –∏ –Ω–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ

#### –ë–ª–æ—á–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞

```
signal[0:N]
  ‚Üì
split into blocks of size B
  ‚Üì
[block‚ÇÅ, block‚ÇÇ, ..., block‚Çñ] –≥–¥–µ k = ‚åäN/B‚åã
```

**–¶–µ–ª—å:** –ê–Ω–∞–ª–∏–∑ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤ –≤ —á–∞—Å—Ç–æ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏

#### –ë—ã—Å—Ç—Ä–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ (FFT)

```
FFT: signal ‚àà ‚Ñù‚Åø ‚Üí spectrum ‚àà ‚ÑÇ‚Åø

X[k] = Œ£(m=0 to N-1) x[m] √ó e^(-2œÄikm/N)

Magnitude[k] = |X[k]| = ‚àö(Re¬≤ + Im¬≤)
```

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** O(n log n) –≤–º–µ—Å—Ç–æ O(n¬≤) –¥–ª—è –î–ü–§

**–§–∏–∑–∏—á–µ—Å–∫–∏–π —Å–º—ã—Å–ª:** –†–∞–∑–ª–æ–∂–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞ –Ω–∞ –≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å —á–∞—Å—Ç–æ—Ç–∞–º–∏ –æ—Ç 0 (DC) –¥–æ Nyquist

#### –≠–Ω–µ—Ä–≥–∏—è –±–ª–æ–∫–∞ –≤ —á–∞—Å—Ç–æ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏

```
BlockEnergy = ‚àö(Œ£ Magnitude[k]¬≤)
```

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:** L2-–Ω–æ—Ä–º–∞ —Å–ø–µ–∫—Ç—Ä–∞ - –º–µ—Ä–∞ –æ–±—â–µ–π "–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏" –≤ —á–∞—Å—Ç–æ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏

#### –ü—Ä–æ–µ–∫—Ü–∏—è –Ω–∞ –±–∞–∑–∏—Å

```
projected[i] = signal[i] √ó basis_lattice[i]

–í —á–∞—Å—Ç–æ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏:
FFT(projected) = —Å–≤–µ—Ä—Ç–∫–∞(FFT(signal), FFT(basis))
```

**‚ö†Ô∏è –í–ê–ñ–ù–û: –≠–§–§–ï–ö–¢ –ú–ê–°–®–¢–ê–ë–ò–†–û–í–ê–ù–ò–Ø**

–ö–æ–≥–¥–∞ —Å–∏–≥–Ω–∞–ª –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è (multiply by Œ±):

```
signal_scaled = Œ± √ó signal

FFT(signal_scaled) = Œ± √ó FFT(signal)

BUT: Magnitude —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –°–û–•–†–ê–ù–Ø–ï–¢–°–Ø!
Magnitude_scaled[k] ‚àù Magnitude_original[k]
```

**–≠—Ç–æ –ù–ê–ú–ï–†–ï–ù–ù–´–ô —ç—Ñ—Ñ–µ–∫—Ç FFT!** –ü—Ä–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–ø–µ–∫—Ç—Ä "–ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è" –ø–æ –∞–º–ø–ª–∏—Ç—É–¥–∞–º, –Ω–æ **–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ –ø–æ —á–∞—Å—Ç–æ—Ç–∞–º –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º**. –ú–µ–¥–∏–∞–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç —ç—Ç–æ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –§—É—Ä—å–µ.

**–†–µ—à–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:** –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—â–∞—è –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å, –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –±–∞–∑–∏—Å:

```rust
// –í–∞—Ä–∏–∞–Ω—Ç 1: –ë–∞–∑–∏—Å —Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
let normalized_basis = Basis {
    lattice: basis_lattice.iter()
        .map(|l| l / basis_norm)
        .collect(),
    weight: 0.5,
};

// –í–∞—Ä–∏–∞–Ω—Ç 2: –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤ score_block_multi_basis
pub fn score_block_multi_basis_normalized(
    block: &[f64],
    bases: &[Basis],
) -> f64 {
    let block_norm = (block.iter().map(|v| v*v).sum::<f64>()).sqrt();
    let normalized_block = block.iter()
        .map(|v| v / block_norm.max(1e-6))
        .collect::<Vec<_>>();
    
    bases.iter().map(|b| {
        let projected = project(&normalized_block, &b.lattice);
        let mag = fft_magnitude(&projected);
        b.weight * block_energy(&mag)
    }).sum()
}
```

#### –ú–Ω–æ–≥–æ–±–∞–∑–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞

```
bases = [
    Basis { lattice: l‚ÇÅ, weight: w‚ÇÅ },
    Basis { lattice: l‚ÇÇ, weight: w‚ÇÇ },
    Basis { lattice: l‚ÇÉ, weight: w‚ÇÉ },
]

ScoreBlock(block, bases) = Œ£ w·µ¢ √ó Energy(FFT(project(block, l·µ¢)))
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —á–∞—Å—Ç–æ—Ç–Ω—ã–µ –ø–æ–¥–¥–∏–∞–ø–∞–∑–æ–Ω—ã
- –í–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏ –±–∞–∑–∏—Å–∞
- –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–∞

#### –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–∞—è –ø–æ–¥–ø–∏—Å—å (–º–µ–¥–∏–∞–Ω–Ω–∞—è —Ä–æ–±—É—Å—Ç–Ω–æ—Å—Ç—å)

```
BlockScores = [score‚ÇÅ, score‚ÇÇ, ..., score‚Çñ]

InvariantSignature = Median(BlockScores)
                   = BlockScores[k/2] (–ø–æ—Å–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏)
```

**–ü–æ—á–µ–º—É –º–µ–¥–∏–∞–Ω–∞ –ª—É—á—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ:**
- –£—Å—Ç–æ–π—á–∏–≤–∞ –∫ –≤—ã–±—Ä–æ—Å–∞–º (outliers)
- –ù–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ –∫ 50% –∞—Ç–∞–∫
- –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–±–∏–≤–∞—é—â–∞—è —Ç–æ—á–∫–∞ (breakdown point) = 50%

**–§–æ—Ä–º—É–ª–∞ —Å –≤–µ—Å–∞–º–∏:**

```
Total = Œ£ w·µ¢ √ó Œ£ E‚±º(block‚±º, basis·µ¢)
           basis    blocks
           
Median-robust scoring –∏—Å–∫–ª—é—á–∞–µ—Ç —Ö—É–¥—à–∏–µ –±–ª–æ–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –§–∞–∑—ã 10

#### –¢–µ—Å—Ç 1: –ë–ª–æ—á–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ ‚úì
- –†–∞–∑–º–µ—Ä 32: **8 –ø–æ–ª–Ω—ã—Ö –±–ª–æ–∫–æ–≤**
- –†–∞–∑–º–µ—Ä 64: **4 –ø–æ–ª–Ω—ã—Ö –±–ª–æ–∫–∞**
- –†–∞–∑–º–µ—Ä 128: **2 –ø–æ–ª–Ω—ã—Ö –±–ª–æ–∫–∞**

#### –¢–µ—Å—Ç 2: FFT —Å–ø–µ–∫—Ç—Ä ‚úì
- –í—Ö–æ–¥–Ω–æ–π –±–ª–æ–∫: 64 –æ—Ç—Å—á–µ—Ç–∞
- FFT —Å–ø–µ–∫—Ç—Ä: 64-—Ç–æ—á–µ—á–Ω—ã–π
- –¢–æ–ø-5 –ø–∏–∫–æ–≤: 31.69, 31.69, 0.80, 0.80, 0.45

#### –¢–µ—Å—Ç 3: –≠–Ω–µ—Ä–≥–∏—è –±–ª–æ–∫–∞ ‚úì
- –í—Å–µ–≥–æ –±–ª–æ–∫–æ–≤: 4
- –î–∏–∞–ø–∞–∑–æ–Ω —ç–Ω–µ—Ä–≥–∏–∏: **28.95 - 65.09**
- –°—Ä–µ–¥–Ω—è—è —ç–Ω–µ—Ä–≥–∏—è: **47.29**

#### –¢–µ—Å—Ç 4: –ü—Ä–æ–µ–∫—Ü–∏—è –Ω–∞ –±–∞–∑–∏—Å ‚úì
- –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å–∏–≥–Ω–∞–ª: 256 –æ—Ç—Å—á–µ—Ç–æ–≤
- –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π: 256 –æ—Ç—Å—á–µ—Ç–æ–≤
- –≠–Ω–µ—Ä–≥–∏—è: **162.16**

#### –¢–µ—Å—Ç 5: –ú–Ω–æ–≥–æ–±–∞–∑–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ ‚úì
```
–ë–∞–∑–∏—Å 1: –≤–µ—Å = 0.50 (–æ—Å–Ω–æ–≤–Ω–æ–π)
–ë–∞–∑–∏—Å 2: –≤–µ—Å = 0.30 (–≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π)
–ë–∞–∑–∏—Å 3: –≤–µ—Å = 0.20 (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π)
```

#### –¢–µ—Å—Ç 6: –ë–ª–æ—á–Ω—ã–π —Å–∫–æ—Ä–∏–Ω–≥ ‚úì

| –ë–ª–æ–∫ | –û—Ü–µ–Ω–∫–∞ |
|------|--------|
| 1 | 40.850 |
| 2 | 18.219 |
| 3 | 39.811 |
| –°—Ä–µ–¥–Ω–µ–µ | 29.606 |

#### –¢–µ—Å—Ç 7: –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–∞—è –ø–æ–¥–ø–∏—Å—å (–º–µ–¥–∏–∞–Ω–Ω–∞—è) ‚≠ê

```
–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–∞—è –ø–æ–¥–ø–∏—Å—å: 39.8106
(–º–µ–¥–∏–∞–Ω–∞ –±–ª–æ—á–Ω—ã—Ö –æ—Ü–µ–Ω–æ–∫ - —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ –≤—ã–±—Ä–æ—Å–∞–º)
```

#### –¢–µ—Å—Ç 8: –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –∞—Ç–∞–∫–∞–º üõ°Ô∏è

| –ê—Ç–∞–∫–∞ | –û—Ü–µ–Ω–∫–∞ | –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|-------|--------|---|---|
| **–®—É–º ¬±0.1** | 39.824 | **100.03%** | ‚úÖ –ò–î–ï–ê–õ–¨–ù–û |
| –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ √ó2.0 | 3.154 | 7.92% | ‚ö†Ô∏è –û–∂–∏–¥–∞–µ—Ç—Å—è |
| **–ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞** | 32.826 | **82.45%** | ‚úÖ –•–û–†–û–®–û |
| **–û–±—Ä–µ–∑–∫–∞ 70%** | 40.850 | **102.61%** | ‚úÖ –û–¢–õ–ò–ß–ù–û |

**–í—ã–≤–æ–¥:** –ú–µ–¥–∏–∞–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç **–∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—É—é —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** –∫:
- ‚úÖ –®—É–º–æ–≤—ã–º –∞—Ç–∞–∫–∞–º (100% –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ)
- ‚úÖ –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞–º (82% –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ)
- ‚úÖ –û–±—Ä–µ–∑–∫–∞–º (103% –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ)

#### –¢–µ—Å—Ç 9: –í–ª–∏—è–Ω–∏–µ –≤–µ—Å–æ–≤ –±–∞–∑–∏—Å–∞ üìä

| –í–µ—Å | –û—Ü–µ–Ω–∫–∞ –ø–æ–¥–ø–∏—Å–∏ | –£–ª—É—á—à–µ–Ω–∏–µ |
|-----|---|---|
| 0.10 | 3.887 | ‚Äî |
| 0.30 | 11.662 | 3.0√ó |
| 0.50 | 19.436 | 5.0√ó |
| 0.70 | 27.210 | 7.0√ó |
| 0.90 | 34.985 | 9.0√ó |

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –û—Ü–µ–Ω–∫–∞ –ª–∏–Ω–µ–π–Ω–∞ –ø–æ –≤–µ—Å—É ‚Üí **—Ç–æ—á–Ω–∞—è —É–ø—Ä–∞–≤–ª—è–µ–º–æ—Å—Ç—å —Å–∏–ª–æ–π –≤–æ–¥—è–Ω–æ–≥–æ –∑–Ω–∞–∫–∞**

#### –¢–µ—Å—Ç 10: –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ —Ä–∞–∑–º–µ—Ä—É –±–ª–æ–∫–∞ üìè

| –†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞ | –û—Ü–µ–Ω–∫–∞ | –¢—Ä–µ–Ω–¥ |
|---|---|---|
| 16 | 4.845 | –ù–∏–∑–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ |
| 32 | 16.932 | **4√ó —É–ª—É—á—à–µ–Ω–∏–µ** |
| 64 | 39.811 | **2.4√ó —É–ª—É—á—à–µ–Ω–∏–µ** |
| 128 | 66.767 | **1.7√ó —É–ª—É—á—à–µ–Ω–∏–µ** |

**–ü—Ä–∏–Ω—Ü–∏–ø –ù–∞–π–∫–≤–∏—Å—Ç–∞:** –ë–æ–ª—å—à–∏–π –±–ª–æ–∫ = –ª—É—á—à–µ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∏–∑–∫–∏–µ —á–∞—Å—Ç–æ—Ç—ã = –±–æ–ª–µ–µ —Å–∏–ª—å–Ω—ã–π –≤–æ–¥—è–Ω–æ–π –∑–Ω–∞–∫

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ò—Ç–æ–≥–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö 10 —Ñ–∞–∑

| –§–∞–∑–∞ | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ö–ª—é—á–µ–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
|------|-----------|--------|---|
| 1 | –ü–æ–∏—Å–∫ –ø–æ —Å–ª–æ–≤–∞—Ä—é | ‚úÖ | 2/4 (50%) |
| 2 | N-–≥—Ä–∞–º–º –º–æ–¥–µ–ª–∏ | ‚úÖ | 38 bigram + 39 trigram |
| 3 | –Ø–∫–æ—Ä—è | ‚úÖ | +5.0 –±–æ–Ω—É—Å –∑–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ |
| 4 | –°–∏–≥–Ω–∞—Ç—É—Ä—ã –≤–æ–¥—è–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤ | ‚úÖ | 0.9816 (–°–ò–õ–¨–ù–û) |
| 5 | –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è & –∞—Ç–∞–∫–∏ | ‚úÖ | 49.00% —Å—Ä–µ–¥–Ω–µ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ |
| 6 | –§–∞–∑–æ–∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω—ã–π —Å–∫–æ—Ä–∏–Ω–≥ | ‚úÖ | 0.7603 —Å—Ä–µ–¥–Ω–µ–µ |
| 7 | –Ø–∫–æ—Ä—è (Anchor-Aware) | ‚úÖ | 100.06% –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —à—É–º–∞ |
| 8 | 3D —Å–µ—Ç–∫–∏ | ‚úÖ | 103.52% –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–µ—Ñ–æ—Ä–º–∞—Ü–∏–∏ |
| 9 | PDF –≤—ã–≤–æ–¥ | ‚úÖ | 10-—Å—Ç—Ä–æ—á–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç |
| 10 | **FFT –º–Ω–æ–≥–æ–±–∞–∑–æ–≤–∞—è** | ‚úÖ | **39.81 –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞** |

### –°—Ç–∞—Ç—É—Å —Å–±–æ—Ä–∫–∏

```
‚úÖ –û—à–∏–±–æ–∫: 0
‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π: 0
‚úÖ –í—Ä–µ–º—è —Å–±–æ—Ä–∫–∏: ~40 —Å–µ–∫ (—Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏)
‚úÖ –†–∞–∑–º–µ—Ä release: ~5 MB
‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É: –ü–û–õ–ù–ê–Ø ‚úÖ
```

---

## üíª –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Rust 1.70+** - https://rustup.rs/
- **Windows 10/11** –∏–ª–∏ Linux
- **Git**

### –®–∞–≥–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
git clone <repo-url>
cd restore_watermark

cargo build --release

./target/release/restore_watermark
```

---

## üìà –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å FFT

| –û–ø–µ—Ä–∞—Ü–∏—è | –í—Ä–µ–º—è | –°–ª–æ–∂–Ω–æ—Å—Ç—å |
|----------|-------|-----------|
| FFT 64 —Ç–æ—á–∫–∏ | < 1 –º–∫—Å | O(n log n) |
| –≠–Ω–µ—Ä–≥–∏—è –±–ª–æ–∫–∞ | < 10 –º–∫—Å | O(n) |
| –ú–Ω–æ–≥–æ–±–∞–∑–æ–≤—ã–π —Å–∫–æ—Ä–∏–Ω–≥ | < 50 –º–∫—Å | O(bases √ó blocks) |
| –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–∞—è –ø–æ–¥–ø–∏—Å—å | < 100 –º–∫—Å | O(k log k) –º–µ–¥–∏–∞–Ω–∞ |
| **–ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª (256 –æ—Ç—Å—á–µ—Ç–æ–≤)** | **~5 –º—Å** | ‚Äî |

### –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏

- –ë—É—Ñ–µ—Ä FFT (256 —Ç–æ—á–µ–∫): ~4 KB
- –°–ø–µ–∫—Ç—Ä—ã (4 –±–ª–æ–∫–∞ √ó 256): ~32 KB
- –ë–∞–∑–∏—Å—ã (3 –≤–µ–∫—Ç–æ—Ä–∞ √ó 256): ~6 KB
- **–í—Å–µ–≥–æ:** < 100 KB ‚úÖ

---

## üî¨ –ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ

### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Å–Ω–æ–≤–∞–Ω–∏–µ FFT

**–î–∏—Å–∫—Ä–µ—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ (–î–ü–§):**

```
X[k] = Œ£(n=0 to N-1) x[n] √ó e^(-2œÄikn/N)

–†–µ–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å:  Re(X[k]) = Œ£ x[n] √ó cos(2œÄkn/N)
–ú–Ω–∏–º–∞—è —á–∞—Å—Ç—å:    Im(X[k]) = Œ£ x[n] √ó sin(2œÄkn/N)

–ú–∞–≥–Ω–∏—Ç—É–¥–∞:       |X[k]| = ‚àö(Re¬≤ + Im¬≤)
–§–∞–∑–∞:            ‚à†X[k] = arctan(Im/Re)
```

**–ë—ã—Å—Ç—Ä–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ (FFT):**
- –ê–ª–≥–æ—Ä–∏—Ç–º –ö—É–ª–∏-–¢—å—é–∫–∏
- –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —á–µ—Ç–Ω—ã–µ/–Ω–µ—á–µ—Ç–Ω—ã–µ
- –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(n log n) vs O(n¬≤) –¥–ª—è –î–ü–§

### –ü–æ—á–µ–º—É –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí —Å–¥–≤–∏–≥ –ø–æ —á–∞—Å—Ç–æ—Ç–∞–º (–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ)

**–°–≤–æ–π—Å—Ç–≤–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è FFT:**

```
–ï—Å–ª–∏ y[n] = Œ± √ó x[n], —Ç–æ:
Y[k] = Œ± √ó X[k]

–í—Å–µ —á–∞—Å—Ç–æ—Ç–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è –Ω–∞ –æ–¥–Ω—É –≤–µ–ª–∏—á–∏–Ω—É!
```

**–≠—Ç–æ –ñ–ï–õ–ê–ï–ú–û–ï –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è –≤–æ–¥—è–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤, –ø–æ—Ç–æ–º—É —á—Ç–æ:**

1. **–ß–∞—Å—Ç–æ—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è** - –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –∞–º–ø–ª–∏—Ç—É–¥—ã –Ω–µ –º–µ–Ω—è—é—Ç—Å—è
2. **–ú–µ–¥–∏–∞–Ω–∞ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç** - –Ω–µ—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–º—É –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é
3. **–õ–∏–Ω–µ–π–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–∞** - –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –±–∞–∑–∏—Å

**–†–µ—à–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—â–∞—è –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å):**

```rust
// –î–æ–±–∞–≤—å—Ç–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –±–∞–∑–∏—Å –≤ –º–Ω–æ–≥–æ–±–∞–∑–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É
let scale_invariant_basis = Basis {
    lattice: original_basis.iter()
        .map(|l| l / original_basis_norm)
        .collect::<Vec<_>>(),
    weight: 0.3,  // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –±–∞–∑–∏—Å
};

// –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–π –ø—Ä–∏–º–µ—Ä–Ω—ã–π –∫–æ–¥ –≤—ã—à–µ (score_block_multi_basis_normalized)
```

### –¢–µ–æ—Ä–∏—è –º–µ–¥–∏–∞–Ω–Ω–æ–π —Ä–æ–±—É—Å—Ç–Ω–æ—Å—Ç–∏

**–¢–æ—á–∫–∞ —Ä–∞–∑–±–∏–≤–∫–∏ (Breakdown Point):**

```
Œµ* = ‚åä(k+1)/2‚åã / k  –≥–¥–µ k = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤

–î–ª—è k=4: Œµ* = 2/4 = 50%

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç: –º–µ–¥–∏–∞–Ω–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–∂–µ –µ—Å–ª–∏ 
50% –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã!
```

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–æ —Å—Ä–µ–¥–Ω–∏–º (mean):**

```
Mean: Œµ* = 0% (–æ–¥–Ω–∞ –ø–ª–æ—Ö–∞—è —Ç–æ—á–∫–∞ –º–æ–∂–µ—Ç –≤—Å–µ –∏—Å–ø–æ—Ä—Ç–∏—Ç—å)
Median: Œµ* = 50% (–ø–æ–ª–æ–≤–∏–Ω–∞ —Ç–æ—á–µ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–ª–æ—Ö–æ–π)
```

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

---

## ‚úÖ –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

- ‚úÖ –í—Å–µ 10 —Ñ–∞–∑ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –ù—É–ª–µ–≤—ã—Ö –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –∏ –æ—à–∏–±–æ–∫
- ‚úÖ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å —Ñ–æ—Ä–º—É–ª–∞–º–∏
- ‚úÖ –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- ‚úÖ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 20 —Ñ–µ–≤—Ä–∞–ª—è 2026  
**–í–µ—Ä—Å–∏—è:** 2.0.0 - –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è FFT –∏ –º–Ω–æ–≥–æ–±–∞–∑–æ–≤—ã—Ö –≤–æ–¥—è–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤